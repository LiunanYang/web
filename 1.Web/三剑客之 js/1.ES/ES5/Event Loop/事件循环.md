# 任务队列 & 执行栈
JS有同步任务、异步任务
- 同步任务：立即执行的代码，比如一个简单输出
- 异步任务：分为宏任务和微任务

任务队列：
- 先进先出的数据结构
- 存储待执行的异步任务

执行栈：
- 后进先出的数据结构
- 存储函数调用的相关信息和执行过程中的所有变量，当函数被执行的时候，它的上下文会被推入栈中，当函数执行完后，它的执行上下文会在栈中弹出
- 执行同步代码时，如果遇到宏任务，会把它放在宏任务队列并等待处理，如果遇到微任务，会把它放在微任务队列并等待处理

# 事件循环
定义：
- 是处理异步事件和回调的机制
- 不断检查执行栈和任务队列，将任务取出，推入执行栈中执行

具体过程：
当执行栈为空时，事件循环会查看任务队列。如果存在宏任务，它会取出一个宏任务并执行它。在执行宏任务的过程中，如果遇到微任务，微任务会被添加到微任务队列中。当宏任务执行完毕后，事件循环会清空微任务队列并执行所有的微任务，然后检查是否还有更多的宏任务等待执行。这个过程会一直持续下去。

### 宏任务（macrotask\task）
任务队列中等待被主线程执行的事件，通常与异步操作相关，比如处理用户输入、网络请求、定时器
- script 整体代码
- setTimeout、setInterval
- requestAnimationFrame（浏览器环境）

### 微任务（microtask\jobs）
当前宏任务执行完后立即执行的异步任务
- Promise 的 then、catch、finally 回调

### Node.js 特殊队列
- process.nextTick 会在本次事件循环的宏任务执行完后，微任务执行前执行，优先级最高
- setImmediate 同上，微任务之前执行，优先级次之
- I/O（Node.js 环境）
